# GRPO Large Test Script: Hybrid vs Non-Hybrid Comparison

Three runs compared using `large_test_script_hybrid.sh` / `large_test_script.sh` on 2x8 GPU nodes, 19 training steps each.

| Run | Model | `--vllm_enforce_eager` | Beaker ID | W&B run | Git commit |
|-----|-------|------------------------|-----------|---------|------------|
| Hybrid + eager | OLMo3.1-7B hybrid | Yes | `01KGT9WPXPAZXJZ41NYZPSTBPR` | `gh5fwpsj` | `11c8f303` |
| Hybrid | OLMo3.1-7B hybrid | No | `01KH96V3G6AR9CZC31K33CEGH3` | `xg463ken` | `2d4875fa` |
| Non-Hybrid | OLMo3.1-7B | No | `01KH6WX3RP57VVNAYD93QH99QP` | `ghdhctnh` | `8bc13901` |

## Summary (averages over all 19 steps)

| Metric | Hybrid + `enforce_eager` | Hybrid (no eager) | Non-Hybrid (OLMo 3.1) |
|--------|:---:|:---:|:---:|
| **Wall clock (min)** | **37** | **24** | **22** |
| **final learner_tok/s_overall** | **715** | **1,766** | **4,699** |
| | | | |
| **Throughput** | | | |
| avg learner_tok/s_step | 990 | 4,265 | 7,307 |
| avg actor_tok/s | 1,299 | 3,014 | 4,027 |
| | | | |
| **Timing (s)** | | | |
| avg total_time | 100.3 | 56.7 | 52.3 |
| avg training_time | 69.4 | 47.7 | 38.3 |
| avg weight_sync | 33.0 | 9.8 | 15.3 |
| sum total_time | 1,906 | 1,077 | 995 |
| sum training_time | 1,319 | 907 | 728 |
| | | | |
| **Reward / Accuracy** | | | |
| avg verifiable_reward | 0.69 | 0.66 | **0.83** |
| avg verifiable_correct_rate | 0.08 | 0.08 | **0.11** |
| avg code_reward | 0.73 | 0.69 | **1.01** |
| avg code_correct_rate | 0.08 | 0.08 | **0.12** |
| avg code_stdio_reward | **0.48** | 0.45 | 0.43 |
| avg code_stdio_correct_rate | 0.07 | 0.06 | **0.08** |

## Key observations

1. **Throughput**: Removing `enforce_eager` brings hybrid from 715 to 1,766 tok/s overall (2.5x), but non-hybrid is still 2.7x faster than that at 4,699 tok/s.

2. **Wall clock**: Despite the throughput gap, hybrid-no-eager (24 min) is close to non-hybrid (22 min) -- only 9% slower. This is because hybrid's weight_sync is 1.6x faster (9.8s vs 15.3s) and training time per step is comparable (47.7s vs 38.3s).

3. **Reward/accuracy**: Non-hybrid is meaningfully better -- 0.83 vs 0.66-0.69 verifiable_reward, 0.11 vs 0.08 correct rate, 1.01 vs 0.69-0.73 code_reward. This is a model quality gap, not a training infra difference (both hybrid runs match each other).

4. **Hybrid with `enforce_eager` is the worst of all worlds** -- slowest throughput (715 tok/s), slowest wall clock (37 min), and same reward as hybrid-no-eager. There's no reason to use it.

## Per-step detail

### Hybrid + enforce_eager

| Step | learner_tok/s_step | actor_tok/s | total_time | training_time | weight_sync | verifiable_reward | verifiable_correct | code_reward | code_correct | code_stdio_reward | code_stdio_correct |
|------|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 1 | 393 | 1,089 | 227.3 | 227.3 | — | 0.70 | 0.08 | 0.65 | 0.08 | 1.04 | 0.12 |
| 2 | 1,686 | 598 | 49.0 | 15.7 | 33.7 | 0.55 | 0.07 | 0.59 | 0.07 | 0.29 | 0.06 |
| 3 | 1,856 | 860 | 46.0 | 15.2 | 32.7 | 0.72 | 0.08 | 0.79 | 0.09 | 0.41 | 0.06 |
| 4 | 971 | 758 | 87.7 | 55.3 | 32.7 | 0.63 | 0.08 | 0.64 | 0.08 | 0.57 | 0.08 |
| 5 | 606 | 2,735 | 132.6 | 99.8 | — | 0.78 | 0.09 | 0.81 | 0.09 | 0.42 | 0.06 |
| 6 | 978 | 713 | 88.2 | 55.7 | 32.9 | 0.77 | 0.09 | 0.80 | 0.09 | 0.53 | 0.08 |
| 7 | 953 | 745 | 103.9 | 71.2 | — | 0.61 | 0.07 | 0.70 | 0.08 | 0.31 | 0.06 |
| 8 | 645 | 629 | 127.5 | 94.7 | — | 0.68 | 0.08 | 0.70 | 0.08 | 0.46 | 0.06 |
| 9 | 660 | 2,613 | 123.4 | 90.6 | — | 0.63 | 0.07 | 0.70 | 0.08 | 0.33 | 0.06 |
| 10 | 710 | 1,048 | 115.3 | 82.9 | — | 0.66 | 0.08 | 0.68 | 0.07 | 0.53 | 0.09 |
| 11 | 855 | 625 | 100.1 | 67.4 | — | 0.70 | 0.08 | 0.73 | 0.08 | 0.48 | 0.06 |
| 12 | 902 | 1,536 | 100.5 | 67.7 | — | 0.55 | 0.07 | 0.56 | 0.07 | 0.49 | 0.06 |
| 13 | 1,108 | 630 | 77.7 | 45.3 | 32.8 | 0.61 | 0.07 | 0.64 | 0.07 | 0.44 | 0.06 |
| 14 | 898 | 1,400 | 94.9 | 62.2 | 33.1 | 0.98 | 0.10 | 1.04 | 0.11 | 0.39 | 0.06 |
| 15 | 1,488 | 2,566 | 60.7 | 28.2 | 32.7 | 0.68 | 0.08 | 0.68 | 0.08 | 0.39 | 0.06 |
| 16 | 779 | 725 | 108.9 | 76.0 | — | 0.80 | 0.09 | 0.81 | 0.09 | 0.62 | 0.06 |
| 17 | 1,194 | 678 | 77.7 | 45.2 | 32.9 | 0.68 | 0.08 | 0.67 | 0.08 | 0.73 | 0.09 |
| 18 | 815 | 3,566 | 104.1 | 71.3 | — | 0.78 | 0.09 | 0.87 | 0.10 | 0.39 | 0.06 |
| 19 | 1,318 | 1,162 | 80.8 | 47.9 | 33.2 | 0.65 | 0.08 | 0.72 | 0.08 | 0.33 | 0.06 |

### Hybrid (no enforce_eager)

| Step | learner_tok/s_step | actor_tok/s | total_time | training_time | weight_sync | verifiable_reward | verifiable_correct | code_reward | code_correct | code_stdio_reward | code_stdio_correct |
|------|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 1 | 357 | 1,360 | 302.9 | 302.9 | — | 0.75 | 0.08 | 0.75 | 0.08 | 0.72 | 0.09 |
| 2 | 8,107 | 2,883 | 15.7 | 5.8 | 10.2 | 0.67 | 0.08 | 0.69 | 0.08 | 0.38 | 0.06 |
| 3 | 9,491 | 3,634 | 17.1 | 8.8 | 9.8 | 0.74 | 0.08 | 0.76 | 0.08 | 0.36 | 0.06 |
| 4 | 10,518 | 4,702 | 19.6 | 10.5 | 9.5 | 0.64 | 0.07 | 0.66 | 0.08 | 0.39 | 0.06 |
| 5 | 1,978 | 2,577 | 53.3 | 43.8 | 9.8 | 0.60 | 0.07 | 0.65 | 0.07 | 0.32 | 0.06 |
| 6 | 1,607 | 3,064 | 83.4 | 73.7 | 10.1 | 0.74 | 0.08 | 0.84 | 0.09 | 0.36 | 0.06 |
| 7 | 3,105 | 2,929 | 42.5 | 33.5 | 9.3 | 0.61 | 0.07 | 0.63 | 0.07 | 0.48 | 0.06 |
| 8 | 1,952 | 2,596 | 60.6 | 51.4 | 9.6 | 0.58 | 0.07 | 0.60 | 0.07 | 0.42 | 0.06 |
| 9 | 2,713 | 2,110 | 36.7 | 27.1 | 9.9 | 0.73 | 0.08 | 0.77 | 0.08 | 0.34 | 0.06 |
| 10 | 3,204 | 3,813 | 52.6 | 43.0 | 10.0 | 0.60 | 0.07 | 0.60 | 0.07 | 0.62 | 0.06 |
| 11 | 7,527 | 3,215 | 20.0 | 10.5 | 9.9 | 0.71 | 0.08 | 0.71 | 0.08 | 0.62 | 0.06 |
| 12 | 2,108 | 2,924 | 57.5 | 47.3 | 10.5 | 0.67 | 0.07 | 0.66 | 0.07 | 0.72 | 0.08 |
| 13 | 4,129 | 3,082 | 34.6 | 24.8 | 10.1 | 0.59 | 0.07 | 0.60 | 0.07 | 0.46 | 0.06 |
| 14 | 1,779 | 2,504 | 63.4 | 54.0 | 9.7 | 0.68 | 0.09 | 0.71 | 0.09 | 0.45 | 0.06 |
| 15 | 4,114 | 2,960 | 33.2 | 23.4 | 10.0 | 0.72 | 0.08 | 0.78 | 0.09 | 0.26 | 0.06 |
| 16 | 1,285 | 2,642 | 86.7 | 77.7 | 9.2 | 0.69 | 0.07 | 0.73 | 0.08 | 0.46 | 0.06 |
| 17 | 6,245 | 3,141 | 22.4 | 12.7 | 10.0 | 0.55 | 0.07 | 0.62 | 0.07 | 0.29 | 0.06 |
| 18 | 2,557 | 3,163 | 52.3 | 43.3 | 9.3 | 0.59 | 0.08 | 0.64 | 0.08 | 0.26 | 0.06 |
| 19 | 8,263 | 3,967 | 22.0 | 12.5 | 9.8 | 0.76 | 0.09 | 0.79 | 0.09 | 0.57 | 0.09 |

### Non-Hybrid (OLMo 3.1)

| Step | learner_tok/s_step | actor_tok/s | total_time | training_time | weight_sync | verifiable_reward | verifiable_correct | code_reward | code_correct | code_stdio_reward | code_stdio_correct |
|------|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|---:|
| 1 | 1,936 | 3,039 | 133.6 | 133.6 | — | 0.87 | 0.10 | 0.92 | 0.11 | 0.71 | 0.08 |
| 2 | 10,087 | 4,243 | 34.9 | 17.9 | 17.3 | 0.76 | 0.10 | 0.92 | 0.10 | 0.42 | 0.09 |
| 3 | 5,873 | 3,583 | 52.8 | 38.0 | 15.1 | 0.75 | 0.10 | 0.90 | 0.11 | 0.48 | 0.07 |
| 4 | 5,859 | 4,040 | 57.8 | 44.5 | 15.0 | 0.99 | 0.12 | 1.11 | 0.12 | 0.56 | 0.09 |
| 5 | 8,870 | 4,151 | 37.6 | 22.9 | 15.2 | 0.69 | 0.10 | 0.75 | 0.10 | 0.38 | 0.09 |
| 6 | 6,523 | 4,292 | 53.4 | 38.7 | 15.0 | 0.77 | 0.10 | 1.06 | 0.12 | 0.29 | 0.07 |
| 7 | 7,324 | 4,446 | 48.9 | 34.4 | 14.9 | 0.82 | 0.11 | 1.02 | 0.12 | 0.43 | 0.09 |
| 8 | 5,985 | 4,495 | 60.8 | 46.0 | 15.1 | 0.81 | 0.11 | 1.12 | 0.14 | 0.41 | 0.08 |
| 9 | 8,522 | 3,825 | 35.9 | 21.1 | 15.2 | 0.72 | 0.09 | 0.94 | 0.10 | 0.38 | 0.08 |
| 10 | 5,135 | 4,505 | 71.0 | 56.2 | 15.1 | 0.89 | 0.11 | 1.15 | 0.13 | 0.41 | 0.08 |
| 11 | 11,927 | 3,770 | 25.5 | 10.5 | 15.3 | 0.70 | 0.10 | 0.97 | 0.11 | 0.31 | 0.08 |
| 12 | 7,026 | 4,291 | 49.9 | 35.2 | 15.1 | 0.88 | 0.11 | 1.03 | 0.12 | 0.43 | 0.07 |
| 13 | 7,225 | 4,050 | 45.7 | 30.9 | 15.2 | 0.89 | 0.11 | 1.05 | 0.12 | 0.33 | 0.07 |
| 14 | 5,712 | 3,863 | 54.5 | 39.8 | 15.2 | 0.83 | 0.10 | 1.05 | 0.12 | 0.41 | 0.07 |
| 15 | 8,901 | 4,094 | 37.1 | 22.2 | 15.4 | 0.91 | 0.11 | 1.08 | 0.13 | 0.52 | 0.08 |
| 16 | 5,113 | 4,275 | 68.2 | 53.6 | 15.1 | 0.93 | 0.11 | 1.04 | 0.12 | 0.54 | 0.08 |
| 17 | 10,916 | 3,990 | 29.6 | 14.9 | 15.1 | 0.79 | 0.10 | 0.96 | 0.11 | 0.42 | 0.08 |
| 18 | 4,049 | 3,400 | 68.8 | 53.8 | 15.4 | 0.84 | 0.10 | 1.05 | 0.12 | 0.30 | 0.07 |
| 19 | 11,848 | 4,160 | 28.5 | 13.7 | 15.2 | 0.95 | 0.12 | 1.11 | 0.13 | 0.46 | 0.08 |
